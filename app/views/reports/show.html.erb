<table>
  <thead>
    <tr>
      <th>Product</th>
    <% orders.each do |order| %>
      <th><%= order.customer.try(:name) || 'Guest' %> - <%= order.number %></th>
    <% end %>
    </tr>
  </thead>
  <tbody>

  <% products_by_variant_id.each do |(variant_id, product)| %>
    <tr>
      <td><%= product.first.name %> - Variant: <%= variant_id %></td>
    <% orders.each do |order| %>
      <td><%= line_items_by_variant_id[variant_id].find { |line_item| line_item.order_id == order.id }.try(:quantity) || 0 %></td>
    <% end %>
    </tr>
  <% end %>

  </tbody>
</table>
